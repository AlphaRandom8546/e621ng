<div id="p-revert-listing">
  <table class="striped autofit">
    <thead>
    <tr>
      <% if CurrentUser.is_janitor? %>
        <th class="post-version-row-select">
          <label><input type="checkbox" id="post-version-select-all"/></label>
        </th>
      <% end %>
      <th width="5%">Post</th>
      <th width="15%">Date</th>
      <th width="10%">User</th>
      <th width="3%">Rating</th>
      <th width="3%">Parent</th>
      <% if CurrentUser.is_moderator? %>
        <th width="5%">IP Address</th>
      <% end %>
      <th>Sources</th>
      <th>Tags</th>
      <th width="7%"></th>
    </tr>
    </thead>
    <tbody>
    <% @post_versions.each do |post_version| %>
      <tr id="post-version-<%= post_version.id %>" data-post-version-id="<%= post_version.id %>">
        <% if CurrentUser.is_janitor? %>
          <td class="post-version-row-select">
            <input type="checkbox" class="post-version-select" <%= "disabled" unless post_version.can_undo?(CurrentUser.user) %>>
          </td>
        <% end %>
        <td><%= link_to("#{post_version.post_id}.#{post_version.version}", post_path(post_version.post_id)) %></td>
        <td><%= compact_time(post_version.updated_at) %></td>
        <td>
          <% if post_version.updater %>
            <%= link_to_user(post_version.updater) %>
          <% end %>
        </td>
        <td><%= post_version.rating %></td>
        <td><%= post_version.parent_id %></td>
        <% if CurrentUser.is_moderator? %>
          <td>
            <%= link_to_ip post_version.updater_ip_addr %>
          </td>
        <% end %>
        <td class="col-expand"><%= post_source_diff(post_version) %></td>
        <td><%= post_version_diff(post_version) %></td>
        <td>
          <% if post_version.can_undo?(CurrentUser.user) %>
            <%= link_to "Undo", undo_post_version_path(post_version), :method => :put, :remote => true %> |
          <% end %>
          <% if post_version.can_revert_to?(CurrentUser.user) %>
            <%= link_to "Revert to", revert_post_path(post_version.post_id, :version_id => post_version.id), :method => :put, :remote => true %>
          <% end %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

