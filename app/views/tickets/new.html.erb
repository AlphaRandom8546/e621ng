<div id="c-tickets">
  <div id="a-new">

    <%= simple_form_for(@ticket) do |f| %>
      <% @found_item = true %>
      <% if params[:type].nil? %>
        <% @found_item = false %>
        <div class='section' style='max-width:80em;'>
          To submit a ticket about a problematic comment, click "Report" on the comment itself.<br/>
          To submit a ticket about a problematic forum post, click "Report" on the post itself.<br/>
          To submit a ticket about a problematic pool, click "Report" on the pool page itself.<br/>
          To submit a ticket about a problematic set, click "Report" on the set page itself.<br/>
          To submit a ticket about a problematic user, click "Report" on the user's profile page.<br/>
          To submit a ticket about a problematic private message, click "Report PM" above the PM itself.<br/>
          To submit a username request, click "Request Username Change" on <a href='/user/home'>the user home page</a>.<br/>
        </div>
      <% elsif CurrentUser.is_anonymous? %>
        <% @found_item = false %>
        <div class='section' style='max-width:80em;'>
          You must be logged in to submit a ticket. Please <a href='/user/login'>log in</a> and try again.
        </div>
      <% elsif @ticket.type_valid %>
        <%= render partial: "tickets/new_types/#{@ticket.qtype}" %>
      <% else %>
        <% @found_item = false %>
        <div class='section' style='max-width:80em;'>
          Hmm, it seems you tried to report something that doesn't make sense.
        </div>
      <% end %>

      <% if @found_item %>
        <%= f.hidden_field :disp_id %>
        <%= f.hidden_field :qtype %>

        <div class='section' style='max-width:80em;'>
          <label for="ticket_reason">
            Reason for complaint
          </label><br/>

          <p class='nomargin'>Note: Abuse of this system will lead to disciplinary action</p>
          <%= dtext_field "ticket", "reason", :value => @ticket.reason, :input_id => "ticket_reason", limit: Danbooru.config.ticket_max_size %>

        </div>
        <%= submit_tag "Submit Complaint" %>
      <% end %>
    <% end %>
  </div>
</div>

<% render partial: 'secondary_links' %>

<% content_for(:page_title) do %>
  New Ticket
<% end %>
